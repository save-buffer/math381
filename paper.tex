\documentclass[10pt]{article}
% We could also do
% \documentclass[10pt, twoside]{article}
% which shifts everything slightly to the
% side which makes it easier to read if
% it's all stapled together. 
\usepackage[doublespacing]{setspace}
\usepackage{mathtools}
\usepackage{array}
\usepackage{booktabs}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{xcolor}
\graphicspath{{.}}
\newtheoremstyle{named}{}{}{}{}{\bfseries}{.}{.5em}{\thmnote{#3}}
\theoremstyle{named}
\newtheorem*{nthm}{Theorem}
\title{Optimizing the Robotics Closet}
\author{Sasha Krassovsky, John Lim, Andrey Ryabtsev}
\begin{document}
\maketitle
\pagebreak

\section{Introduction}
The Husky Robotics team is a team of both undergraduate and graduate students
from UW building a Mars rover to compete in the University Rover Challenge.
The rover must perform a variety of tasks, such as autonomous navigation, soil
collection, and typing on a keyboard with a robotic arm. The team is divided
into subsystems: Chassis, Arm, Science, Electronics, Software, and Manufacturing.
The subsystems work independently but collaborate to create the robot. Given
all these tasks and the relatively short amount of time given to build out the
functionality, efficiency is key when it comes to the build process.
\par
The robotics team has only a small closet in the Mechanical Engineering Building.
The closet stores the robot along with all of the tools, electronics, sheet metal,
carbon fiber, and plastics that go into building the robot. Each item belongs to
one of the subsystems, and is usually stored near other items belonging to that
subsystem. Unfortunately, the robotics closet is not particularly organized, and
members often spend on the order of 10 minutes looking for the thing they needed.
Our goal is to find a reorganization plan for the items in the closet such that
expected duration of each closet visit is minimized and items belonging to the
same subsystem are in the same connected component on the shelves.
\par
The closet has two shelves, one on each side. One side stores items in
uniformly-sized boxes while the other side has several other classes of items,
such as soldering irons, and boxes of various sizes. The rover is stored in
the middle of the room on a big cart. Behind it is the robotic arm and the
vscience station. In the back are the sheet metal, various metallic cylinders,
wood, and rolls of carbon fiber. By examining the frequencies of retrieval
by each team and treating the closet as a grid, we should be able to produce
a better layout of the closet.

\begin{center}
  \includegraphics[scale=0.15]{closet.jpg} \\
  The robotics closet before optimization. 
\end{center}

\section{Related Work}
Deepesh Singh's \emph{A Beginnerâ€™s guide to Shelf Space Optimization using Linear Programming}
explains an integer programming formulation for finding the optimal layout of a store
that maximizes sales. The guide organizes the store into several racks, each with
a certain number of shelves. One key assumption is that only one product can fit
on a rack. The model uses a table showing how many sales are generated by each item
depending on which rack it is placed. The objective function is then the profit
generated by a given arrangement. Arrangements are represented by a matrix, with
each $a_{ij}$ representing whether product $j$ is on shelf $i$. If it is, the
$a_{ij}$ is $1$ and $0$ otherwise. The guide shows how to maximize this profit function.
Although this approach is a good start, our problem differs in several ways: we can
fit more than one box on each shelf, and our goal is to minimize time of retrieval
rather than maximize profits.

\textbf{\color{red} TODO: More related work}

\section{Assumptions}
Most items in the robotics closet are in boxes. As a result, we assume that all
items are rectangular prisms. Although items such as the chemicals or soldering irons
are not strictly rectangle-shaped, it would be strange for another item reached into
the empty areas of the items' bounding boxes. Taking advantage of this, we approximate
all items as being rectangular prisms, and measure their bounding boxes.
\par
We also assumed that certain parts of the robotics closet are not to be moved. For example, the shelf containing aluminum brackets and blocks for machining was excluded from the model entirely. This is due to the cumbersome nature of moving hundreds of unboxed chunks of metal, and due to opposition to its transportation by team members who frequently use it. The food pantry portion as well as some non-food items that made their way into it was similarly excluded after brief deliberation. Excluding parts of the closet from the model does not reduce the validity of the remaining optimization since the access to other closets is unaffected by the contents of these.
\par
Another simplifying assumption we made is that all drawers have one unit of depth. In other words, we cannot insert items one behind another. This is a valid assumption to make because having to pull an item from behind another would drastically reduce the retrieval time of both items, undoing much of the benefits of our optimization. This can be adjusted to be a soft constraint (penalize heavily for items that are one behind another) if the model is infeasible without this change. In the meantime, we are reasonably confident that disallowing multiple units of depth is the best approach keeping in mind our ultimate goal of convenience.


\section{Model}
We collected data from the robotics closet by measuring each item and shelf. Each
shelf $s$ is represented as an ordered triple $(d, a, c)$, where $d$ is the
distance from the door in ``shelf-lengths'', $a$ is the area of the shelf, and
$c$ is the connected components to which the self belongs.
\par
Each item is represented with an ordered triple $(a, p, s)$, where $a$ is the area
of the item, $p$ is the probability that the item is selected, and $s$ is the item's
subsystem. Notice that we represent each item as a 2-dimensional area. This is valid
because we assumed that each shelf had a single unit of depth. As a preprocessing step,
we choose to minimize the area. However, we cannot rotate always the item into a
horizontal orientation. Therefore, $h$ is constant. For an item $i$ with length $l_i$,
width $w_i$, and height $h_i$, its area $a_i$ is given by 
$$a_i = \min(l_i, w_i) \cdot h_i$$
\par
Let there be $n$ shelves and $m$ items, $k$ subsystems, and $l$ is the number of
connected components. Our decision variables lie in two matrices
$$W = (w_{ij}), 1 \leq i \leq n, 1 \leq j \leq m$$
$$C = (c_{ij}), 1 \leq i \leq l, 1 \leq j \leq k$$
Each $w_{ij}$ and $c_{ij}$ is a binary variable, i.e. each $w_{ij}, c_{ij} \in {0, 1}$.
Each $w_{ij}$ is $0$ if item $j$ is not on shelf $i$ and $1$ otherwise. $c_{ij}$ is
$1$ if subsystem $j$ lies in connected component $i$ and $0$ otherwise. 
$C$ is a $l \times k$ matrix because there are l connected components and k subsystems. \\
Note about notation: $a^i_k$ indicates the area of item $k$ while $a^s_k$ indicates the
area of shelf k. $I$ is the set of items and $S$ is the set of shelves. For any item
$x$, $p_x$ and $s_x$ represent the item's probability and subsystem respectively. 
\par
The model is subject to the following constraints:
\begin{enumerate}
\item $\sum_{j = 1}^{m}w_{ij}a^i_j \leq w^s_i, 1 \leq i \leq n$.
\item $\sum_{j = 1}^{n}w_{ji} = 1, 1 \leq i \leq m$.
\item $\sum_{j = 1}^{l}c_{ji} = 1, 1 \leq i \leq k$.
\item Let $K$ be the set of indices of items belonging to subsystem $i$. Let
  Let $L$ be the set of indices of shelves belonging to connected component $j$.
  Then $\sum_{a \in K}\sum_{b \in L}w_{ba} = |K| \cdot c_{ji}, 1 \leq i \leq k, 1 \leq j \leq l$.
\end{enumerate}
Since each probability $p$ is less than 1, we incentivize putting items with higher probability
in the front by multiplying the probability by the distance. Thus, our objective function
becomes
$$\min z = \sum_{i = 1}^{n}\sum_{j = 1}^{m} d_j p_i w_{ij}$$

\textbf{Explanation of Constraints:}
\begin{enumerate}
\item The sum of all of the items on a given shelf must be less than or equal to
  the maximum area that the shelf can support. We multiply by $w_{ji}$ so that
  items not included on the shelf are not counted.
\item Each column of $W$ can only have one $1$, because we cannot put an item
  on two shelves simultaneously. Since each row represents a shelf, we simply
  traverse the whole column and ensure its sum is exactly $1$. Notice that if
  we had put $\leq 1$, the constraint would have been invalid because then
  no items would have been included. Thus, this constraint implicitly enforces
  the constraint that every item be included.
\item Each column of $C$ can only have one $1$ because all items belonging to
  a subsystem must be in the same connected component, and therefore a subsystem
  can be in exactly one connected component. Similarly to constraint 2, summing
  this and ensuring that the sum is 1 enforces the idea that every subsystem is
  included.
\item The intuition behind this constraint is that either all items belonging
  to a subsystem are in the same connected component, or none are. Thus, we
  use the decision variable $c_{ji}$ to choose whether the sum is $0$ or not.
\end{enumerate}

\section{Solution and Results}
We used the Gurobi optimization library to solve the formulated integer programming
problem. The results placed 11 items into Shelf 5, 16 items into Shelf 6, 13 items
into Shelf 7, 13 items into Shelf 8, 11 items into Shelf 9, 2 into 10, 1 into 11,
2 into 12, and 11 into 13. The remaining shelves had no items placed in them.
This confirmed our intuition that there was plenty of space for the items
even with the single depth layer constraint. A brief examination of the items
allocated to each specific shelf provides support for validity of the model;
it is not difficult to imagine the items listed placed compactly, but plausibly.
\par
Only the shelves that have distance 2 (highest distance in the input data set)
are left empty. This is an indication that proximity is, in fact, taken into
account by the model. Finally, LiPo batteries are placed onto the same drawer,
as are NVIDIA Jetsons and other closely related items. This validates that the
connected components constraint is being considered.

\section{Improvements}
We noticed that the model packed together very many items while leaving four
perfectly good shelves empty. Especially when considering that there are items
we likely forgot to catalogue, as well as items that would get added later on,
we may consider adding space remaining in shelves as a soft constraint. This
could be done by either reducing the width of each shelf or by padding the
items on all sides to imply that there must be room between each item. This
would also have the added benefit of making items easier to take out, since
it is illogical to stuff some shelves to the last inch while leaving whole
drawers to collect dust.

\section{Conclusions}
In conclusion, we are happy to have found an integer programming approach
with the aforementioned constraints and objective function to be successful
at finding a reasonably optimal arrangement of items. We were able to learn
the practical challenges of solving a real-world linear programming problem,
whilst still getting a result that has legitemate applications. 

\section{Acknowledgements}
We would like to thank:
\begin{itemize}
\item Dr. Sara Billey for providing us with guidance throughout the project,
\item Hongyu Cao for supplying us with a paper that inspired a significant portion of our thoughts on the problem,
\item UW Husky Robotics for providing the closet to undergo optimization,
\item Nolan Donovan for working with us to understand and solve this problem.
\end{itemize}
\end{document}
